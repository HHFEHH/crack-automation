{% extends 'base.html' %} 

{% load static %} 

{% block style %}
<link rel="stylesheet" href="{% static 'css/flatting.css' %}" />
{% endblock %} 

{% block content %}
<section class="section">
  <canvas id="canvas"></canvas>
  <form action="{% url 'flattingResult' %}" method="post">
    {% csrf_token %}
    <input type="hidden" id="topLeft" name="x" value="0,0" />
    <input type="hidden" id="topLeft" name="y" value="0,0" />
    <input type="hidden" id="topLeft" name="w" value="0,0" />
    <input type="hidden" id="topLeft" name="z" value="0,0" />
    <input type="hidden" name="pk" value="{{img.id}}" />

    <!-- <div class="image">
      <img src="{{crack.image.url}}" alt="image" id="image" />
    </div> -->

    <div class="submit">
      <button id="button" type="submit">등록하기</button>
    </div>
  </form>
</section>
{% endblock %}

{% block script %}
<script>
  let points = [];
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const button = document.getElementById("button");
  const image = new Image();

  image.src = '{{crack.image.url}}'
  console.log(image.src)
  image.addEventListener('load', function() {
    const width = image.width;
    const height = image.height;
    canvas.width = width;
    canvas.height = height;
    button.style.width = width + 'px';
    ctx.drawImage(image, 0, 0, width, height);
  })
  

</script>
{% endblock %}